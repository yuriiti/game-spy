---
name: Игра Шпион на React
overview: Создание мобильного веб-приложения "Шпион" на React с передачей телефона между игроками, голосованием во время игры, раундами до победы, таймером, настройкой количества игроков, количества шпионов и выбором категорий слов.
todos:
  - id: setup
    content: "Настройка React проекта с TypeScript: создание структуры папок, установка зависимостей, настройка tsconfig.json, базовый App.tsx"
    status: completed
  - id: types
    content: "Создание файла game.types.ts с TypeScript интерфейсами: GameState (с полями spyCount, players, activePlayers, votes, timerDuration, showCategoryToSpy, showLetterCountToSpy, showFirstLetterToSpy), Player (с полями name, role, isActive, isSpy), GameStage, WordCategory, VotingState и другие необходимые типы"
    status: completed
  - id: words_db
    content: Создание файла words.json с категориями слов (животные, города, профессии, предметы, еда) по 20 слов на категорию
    status: completed
  - id: hint_questions
    content: "Создание файла hintQuestions.json со списком абстрактных вопросов-подсказок для помощи игрокам (например: 'Где это можно найти?', 'Как это выглядит?', 'Когда это используется?' и т.д.)"
    status: completed
  - id: game_logic
    content: "Реализация утилиты gameLogic.ts: функции распределения ролей (поддержка нескольких шпионов), выбора слова, формирования подсказок для шпиона (категория, количество букв, первая буква) согласно настройкам, подсчета голосов, определения выбывшего игрока, проверки победы после каждого голосования (проверка оставшихся шпионов, условие победы шпиона при 1 шпионе и 1 местном жителе), логика продолжения игры"
    status: completed
  - id: setup_component
    content: "Компонент GameSetup: ввод имен игроков (3-10), выбор количества шпионов (1 до количества игроков-1), категории слов, времени длительности таймера, опции показа подсказок шпиону: категория (true/false), количество букв (true/false), первая буква (true/false)"
    status: completed
  - id: role_reveal
    content: "Компонент RoleReveal: показ имени следующего игрока, при нажатии на экран - показ роли (слово для местного или 'шпион' + подсказки для шпиона согласно включенным опциям: категория, количество букв, первая буква), переход к следующему игроку"
    status: completed
  - id: timer
    content: "Компонент Timer: обратный отсчет с настраиваемым временем из настроек игры, отображение на игровом экране"
    status: completed
  - id: gameplay
    content: "Компонент Gameplay: игровой экран с таймером сверху, секцией подсказок вопросов (отображение одного вопроса, кнопка 'след. вопрос' для переключения), интерфейсом голосования, список активных игроков с кнопками голосования, отслеживание голосов"
    status: completed
  - id: voting_result
    content: "Компонент VotingResult: показ результата голосования (кто выбыл, его роль), проверка условия победы, переход к продолжению игры или финальным результатам"
    status: completed
  - id: final_results
    content: "Компонент FinalResults: показ финальных результатов игры (победитель, кто был шпионом/шпионами, возможность начать новую игру)"
    status: completed
  - id: styling
    content: "Стилизация всех компонентов: темная тема интерфейса, мобильный-first дизайн, крупные кнопки, понятная навигация, полноэкранный режим"
    status: completed
---

# План реализации игры "Шпион"

## Архитектура приложения

Игра будет состоять из следующих основных компонентов:

1. **Настройка игры** - ввод имен игроков, выбор количества шпионов, категории слов, времени таймера, опции подсказок шпиону (категория, количество букв, первая буква)
2. **Экран распределения ролей** - передача телефона: показ имени следующего игрока, при нажатии - роль (слово или "шпион")
3. **Игровой экран** - обсуждение с таймером и одновременным интерфейсом голосования
4. **Экран результатов голосования** - показ результата голосования (кто выбыл, его роль)
5. **Экран финальных результатов** - показ победителя игры

## Структура файлов

```javascript
src/
├── App.tsx                 # Главный компонент с роутингом состояний
├── components/
│   ├── GameSetup.tsx       # Настройка игры (ввод имен игроков, количество шпионов, категория, время таймера, подсказки шпиону: категория, количество букв, первая буква)
│   ├── RoleReveal.tsx     # Передача телефона: показ имени следующего игрока, при нажатии - роль
│   ├── Gameplay.tsx       # Игровой экран с таймером и интерфейсом голосования одновременно
│   ├── VotingResult.tsx   # Результат голосования (кто выбыл, его роль, продолжение или победа)
│   ├── FinalResults.tsx   # Финальные результаты игры (победитель)
│   └── Timer.tsx          # Компонент таймера
├── data/
│   ├── words.json         # База слов по категориям
│   └── hintQuestions.json # Список абстрактных вопросов-подсказок для игроков
├── types/
│   └── game.types.ts      # TypeScript типы и интерфейсы для игры
├── utils/
│   └── gameLogic.ts       # Логика игры (распределение ролей, проверка победы)
└── styles/
    └── App.css            # Стили приложения
```



## Основные функции

### 1. Управление состоянием игры

- Использование React useState для хранения:
- Списка игроков с именами
- Количества шпионов
- Выбранной категории
- Времени длительности таймера (в минутах или секундах)
- Флагов показа подсказок шпиону:
    - Показать категорию (true/false)
    - Показать количество букв (true/false)
    - Показать первую букву (true/false)
- Текущего слова
- Роли каждого игрока (шпион/местный)
- Текущего этапа игры
- Активных игроков (не выбывших)
- Голосов каждого игрока
- Текущего индекса игрока при показе ролей
- Состояния голосования (кто за кого проголосовал)

### 2. База слов

- Файл `words.json` с категориями:
- Животные
- Города
- Профессии
- Предметы
- Еда
- Каждая категория содержит массив слов

### 3. Игровая механика

- Ввод имен всех игроков в начале игры
- Случайный выбор слова из выбранной категории
- Случайное назначение заданного количества игроков шпионами
- Валидация: количество шпионов должно быть меньше количества игроков (минимум 1 местный житель)
- Показ ролей: по очереди показывается имя следующего игрока, при нажатии на экран - его роль:
- Для местного жителя: загаданное слово
- Для шпиона: "шпион" + подсказки (если включены опции):
    - Категория слова
    - Количество букв в слове
    - Первая буква слова
- После показа всех ролей начинается игра
- Игровой экран: таймер + интерфейс голосования одновременно
- Голосование: любой активный игрок может проголосовать за любого активного игрока
- Когда все активные игроки проголосовали - показывается результат голосования
- Игрок с наибольшим количеством голосов выбывает
- Проверка после выбытия:
- Если выбыл местный житель → он выбывает, проверка условия победы:
    - Если остался 1 шпион и 1 местный житель → победа шпиона
    - Иначе игра продолжается (новый раунд голосования)
- Если выбыл шпион:
    - Если шпионов больше не осталось → победа мирных жителей
    - Если шпионы еще остались → шпион выбывает, проверка условия победы:
    - Если остался 1 шпион и 1 местный житель → победа шпиона
    - Иначе игра продолжается (новый раунд голосования)
- Игра может продолжаться несколько раундов голосования до победы одной из сторон

### 4. Интерфейс

- Мобильное веб-приложение (адаптивный дизайн для смартфонов)
- Темная тема интерфейса (темный фон, светлый текст)
- Простой и понятный UI на русском языке
- Крупные кнопки и элементы для удобства на мобильных устройствах
- Полноэкранный интерфейс для передачи телефона
- При показе ролей: большой текст с именем игрока, при нажатии - роль
- Игровой экран: таймер сверху, секция с подсказками вопросов (один вопрос + кнопка "след. вопрос"), список игроков с кнопками голосования снизу
- Четкие переходы между этапами игры
- Визуальная индикация выбывших игроков

## Технические детали

- React с TypeScript
- TypeScript типы для всех компонентов и утилит
- Интерфейсы для игрового состояния, игроков, слов
- React без дополнительных библиотек (только базовый React)
- Локальное хранение состояния (useState с типизацией)
- Простая навигация через условный рендеринг компонентов
- Мобильный-first дизайн (оптимизация для смартфонов)
- Поддержка touch-событий для передачи телефона
- Настройка tsconfig.json для React проекта

## Последовательность реализации

1. Настройка React проекта с TypeScript (tsconfig.json, зависимости, мобильная оптимизация)
2. Создание TypeScript типов и интерфейсов (game.types.ts) с поддержкой имен игроков, выбывших игроков, голосования
3. Создание базы слов (words.json) с категориями
4. Создание списка вопросов-подсказок (hintQuestions.json)
5. Реализация логики распределения ролей, голосования, выбытия игроков, проверки победы
6. Реализация компонента настройки игры (ввод имен игроков)